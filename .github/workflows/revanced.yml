name: ReVanced
on:
  workflow_dispatch:
  schedule:
  - cron: '0 18 1 * *'
jobs:
  ReVanced:
    runs-on: ubuntu-latest
    steps:
    - name: ReVanced
      run: |
        sudo apt install -yqq openjdk-19-jre
        wget "https://downloadr2.apkmirror.com/wp-content/uploads/2022/12/07/639e76ef59b91/com.google.android.youtube_17.49.37-1533275584_minAPI26(arm64-v8a,armeabi-v7a,x86,x86_64)(nodpi)_apkmirror.com.apk?verify=1672764550-plhG9ivaA5zANJ-EyW9sYSRVGtDoNU1aZ4JLNJnmvGA"
        wget -q https://github.com/revanced/revanced-integrations/releases/latest/download/app-release-unsigned.apk
        curl -s https://api.github.com/repos/revanced/revanced-patches/releases/latest | grep browser_download_url.*jar | cut -d : -f 2,3 | tr -d \" | wget -qi -
        curl -s https://api.github.com/repos/revanced/revanced-cli/releases/latest | grep browser_download_url.*jar | cut -d : -f 2,3 | tr -d \" | wget -qi -
        java -jar revanced-cli*.jar -a com.google.android.youtube.apk -o revanced.apk -b revanced-patches*.jar --exclusive --experimental -m app-release-unsigned.apk -i video-ads -i microg-support -i general-ads -i minimized-playback
    - name: Upload
      uses: svenstaro/upload-release-action@v2
      with:
        file: revanced.apk
        overwrite: true
